{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/auth/index.js","webpack:///./src/auth/router.js","webpack:///./src/auth/store.js","webpack:///./src/exercise/index.js","webpack:///./src/exercise/router.js","webpack:///./src/exercise/store.js","webpack:///./src/index.js","webpack:///./src/utils/constants.js","webpack:///./src/utils/index.js","webpack:///./src/utils/middlewares.js","webpack:///./src/utils/wss.js","webpack:///external \"@koa/cors\"","webpack:///external \"http\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-jwt\"","webpack:///external \"koa-router\"","webpack:///external \"nedb-promise\"","webpack:///external \"ws\""],"names":["router","Router","createToken","user","jwt","sign","username","_id","jwtConfig","secret","expiresIn","createUser","response","userStore","insert","body","token","status","err","issue","error","message","post","ctx","request","credentials","findOne","password","UserStore","constructor","filename","autoload","store","dataStore","props","get","userId","state","exerciseStore","find","exercise","params","id","createExercise","console","log","broadcast","type","payload","put","exerciseId","updatedCount","update","del","remove","ExerciseStore","app","Koa","server","http","createServer","callback","wss","WebSocket","Server","initWss","use","cors","timingLogger","exceptionHandler","bodyParser","prefix","publicApiRouter","authRouter","routes","allowedMethods","protectedApiRouter","exerciseRouter","listen","next","start","Date","now","method","url","value","on","ws","JSON","parse","close","verify","data","clients","forEach","client","readyState","OPEN","send","stringify"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export * from './router';","import Router from 'koa-router';\nimport userStore from './store';\nimport jwt from 'jsonwebtoken';\nimport { jwtConfig } from '../utils';\n\nexport const router = new Router();\n\nconst createToken = (user) => {\n  return jwt.sign({ username: user.username, _id: user._id }, jwtConfig.secret, { expiresIn: 60 * 60 * 60 });\n};\n\nconst createUser = async (user, response) => {\n  try {\n    await userStore.insert(user);\n    response.body = { token: createToken(user), _id: user._id };\n    response.status = 201; // created\n  } catch (err) {\n    response.body = { issue: [{ error: err.message }] };\n    response.status = 400; // bad request\n  }\n};\n\nrouter.post('/signup', async (ctx) => await createUser(ctx.request.body, ctx.response));\n\nrouter.post('/login', async (ctx) => {\n  const credentials = ctx.request.body;\n  const response = ctx.response;\n  const user = await userStore.findOne({ username: credentials.username });\n  if (user && credentials.password === user.password) {\n    response.body = { token: createToken(user), _id: user._id };\n    response.status = 201; // created\n  } else {\n    response.body = { issue: [{ error: 'Invalid credentials' }] };\n    response.status = 400; // bad request\n  }\n});\n","import dataStore from 'nedb-promise';\n\nexport class UserStore {\n  constructor({ filename, autoload }) {\n    this.store = dataStore({ filename, autoload });\n  }\n  \n  async findOne(props) {\n    return this.store.findOne(props);\n  }\n  \n  async insert(user) {\n    //\n    return this.store.insert(user);\n  };\n}\n\nexport default new UserStore({ filename: './db/users.json', autoload: true });","export * from './router';","import Router from \"koa-router\";\nimport exerciseStore from \"./store\";\nimport { broadcast } from \"../utils/wss.js\";\n\nexport const router = new Router();\n\nrouter.get(\"/exercises\", async (ctx) => {\n  const response = ctx.response;\n  const userId = ctx.state.user._id;\n  response.body = await exerciseStore.find({ userId });\n  response.status = 200; // ok\n});\n\nrouter.get(\"/exercise/:id\", async (ctx) => {\n  const userId = ctx.state.user._id;\n  const exercise = await exerciseStore.findOne({ _id: ctx.params.id });\n  const response = ctx.response;\n  if (exercise) {\n    if (exercise.userId === userId) {\n      response.body = exercise;\n      response.status = 200; // ok\n    } else {\n      response.status = 403; // forbidden\n    }\n  } else {\n    response.status = 404; // not found\n  }\n});\n\nconst createExercise = async (ctx, exercise, response) => {\n  console.log(\"SE CREEAZA UN EXERCITIU\");\n  try {\n    const userId = ctx.state.user._id;\n    exercise.userId = userId;\n    response.body = await exerciseStore.insert(exercise);\n    response.status = 201; // created\n    broadcast(userId, { type: \"created\", payload: response.body });\n  } catch (err) {\n    response.body = { message: err.message };\n    response.status = 400; // bad request\n  }\n};\n\nrouter.post(\n  \"/exercise\",\n  async (ctx) => await createExercise(ctx, ctx.request.body, ctx.response)\n);\n\nrouter.put(\"/exercise/:id\", async (ctx) => {\n  console.log(\"SE EDITEAZA UN EXERCITIU\");\n  const exercise = ctx.request.body;\n  const id = ctx.params.id;\n  const exerciseId = exercise._id;\n  const response = ctx.response;\n  if (exerciseId && exerciseId !== id) {\n    response.body = { message: \"Param id and body _id should be the same\" };\n    response.status = 400; // bad request\n    return;\n  }\n  const userId = ctx.state.user._id;\n  exercise.userId = userId;\n  const updatedCount = await exerciseStore.update({ _id: id }, exercise);\n  if (updatedCount === 1) {\n    response.body = exercise;\n    response.status = 200; // ok\n    broadcast(userId, { type: \"updated\", payload: exercise });\n  } else {\n    response.body = { message: \"Resource no longer exists\" };\n    response.status = 405; // method not allowed\n  }\n});\n\nrouter.del(\"/exercise/:id\", async (ctx) => {\n  const userId = ctx.state.user._id;\n  const exercise = await exerciseStore.findOne({ _id: ctx.params.id });\n  if (exercise && userId !== exercise.userId) {\n    ctx.response.status = 403; // forbidden\n  } else {\n    await exerciseStore.remove({ _id: ctx.params.id });\n    ctx.response.status = 204; // no content\n  }\n});\n","import dataStore from \"nedb-promise\";\n\nexport class ExerciseStore {\n  constructor({ filename, autoload }) {\n    this.store = dataStore({ filename, autoload });\n  }\n\n  async find(props) {\n    return this.store.find(props);\n  }\n\n  async findOne(props) {\n    return this.store.findOne(props);\n  }\n\n  async insert(exercise) {\n    return this.store.insert(exercise);\n  }\n\n  async update(props, exercise) {\n    return this.store.update(props, exercise);\n  }\n\n  async remove(props) {\n    return this.store.remove(props);\n  }\n}\n\nexport default new ExerciseStore({\n  filename: \"./db/exercises.json\",\n  autoload: true,\n});\n","import Koa from \"koa\";\nimport WebSocket from \"ws\";\nimport http from \"http\";\nimport Router from \"koa-router\";\nimport bodyParser from \"koa-bodyparser\";\nimport { timingLogger, exceptionHandler, jwtConfig, initWss } from \"./utils\";\nimport { router as exerciseRouter } from \"./exercise\";\nimport { router as authRouter } from \"./auth\";\nimport jwt from \"koa-jwt\";\nimport cors from \"@koa/cors\";\n\nconst app = new Koa();\nconst server = http.createServer(app.callback());\nconst wss = new WebSocket.Server({ server });\ninitWss(wss);\n\napp.use(cors());\napp.use(timingLogger);\napp.use(exceptionHandler);\napp.use(bodyParser());\n\nconst prefix = \"/api\";\n\n// public\nconst publicApiRouter = new Router({ prefix });\npublicApiRouter.use(\"/auth\", authRouter.routes());\napp.use(publicApiRouter.routes()).use(publicApiRouter.allowedMethods());\n\napp.use(jwt(jwtConfig));\n\n// protected\nconst protectedApiRouter = new Router({ prefix });\nprotectedApiRouter.use(\"/items\", exerciseRouter.routes());\napp.use(protectedApiRouter.routes()).use(protectedApiRouter.allowedMethods());\n\nserver.listen(3000);\nconsole.log(\"started on port 3000\");\n","export const jwtConfig = { secret: 'my-secret' };\n","export * from './constants';\nexport * from './middlewares';\nexport * from './wss';\n","export const exceptionHandler = async (ctx, next) => {\n  try {\n    return await next();\n  } catch (err) {\n    ctx.body = { message: err.message || 'Unexpected error.' };\n    ctx.status = err.status || 500;\n  }\n};\n\nexport const timingLogger = async (ctx, next) => {\n  const start = Date.now();\n  await next();\n  console.log(`${ctx.method} ${ctx.url} => ${ctx.response.status}, ${Date.now() - start}ms`);\n};\n","import WebSocket from \"ws\";\nimport jwt from \"jsonwebtoken\";\nimport { jwtConfig } from \"./constants\";\n\nlet wss;\n\nexport const initWss = value => {\n  wss = value;\n  wss.on('connection', ws => {\n    ws.on('message', message => {\n      const { type, payload: { token } } = JSON.parse(message);\n      if (type !== 'authorization') {\n        ws.close();\n        return;\n      }\n      try {\n        ws.user = jwt.verify(token, jwtConfig.secret);\n      } catch (err) {\n        ws.close();\n      }\n    })\n  });\n};\n\nexport const broadcast = (userId, data) => {\n  if (!wss) {\n    return;\n  }\n  wss.clients.forEach(client => {\n    if (client.readyState === WebSocket.OPEN && userId === client.user._id) {\n      console.log(`broadcast sent to ${client.user.username}`);\n      client.send(JSON.stringify(data));\n    }\n  });\n};\n","module.exports = require(\"@koa/cors\");","module.exports = require(\"http\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"koa\");","module.exports = require(\"koa-bodyparser\");","module.exports = require(\"koa-jwt\");","module.exports = require(\"koa-router\");","module.exports = require(\"nedb-promise\");","module.exports = require(\"ws\");"],"sourceRoot":""}